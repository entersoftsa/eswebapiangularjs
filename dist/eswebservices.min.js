(function(){"use strict";var t=angular.module("esWebServices",["ngStorage"]);t.constant("ESWEBAPI_URL",{login:"api/Login",publicQuery:"api/rpc/PublicQuery/",userSites:"api/Login/Usersites",scrollerRootTable:"api/rpc/SimpleScrollerRootTable/",newEntityAction:"api/Entity/",entityActionByCode:"api/Entity/",entityActionByGID:"api/EntityByGID/"});function e(t,e){return t.indexOf(e,t.length-e.length)!==-1}function o(t){var e=false;if(typeof t.__esrequest_sesssion!=="undefined"&&t.__esrequest_sesssion!==null){e=t.__esrequest_sesssion}if(e){return"Bearer "+e.WebApiToken}else{return""}}t.provider("esWebApiService",function(){var t={host:"",subscriptionId:"",subscriptionPassword:""};return{settings:function(o){if(angular.isDefined(o)){t=o;if(!t.host||t.host.trim()==""){throw"host for Entersoft WEB API Server is not specified"}if(t.host){t.host=t.host.trim();if(!e(t.host,"/")){t.host+="/"}}return this}else{return t}},$get:["$http","$sessionStorage","ESWEBAPI_URL",function(e,i,s){return{login:function(o){delete i.__esrequest_sesssion;return e({method:"post",url:t.host+s.login,data:{SubscriptionID:t.subscriptionId,SubscriptionPassword:t.subscriptionPassword,Model:o}})},setUser:function(t){var e=t.Model;i.__esrequest_sesssion=e},scrollerRootTable:function(n,r,u){var a=t.host.concat(s.scrollerRootTable,n,"/",r);return e({method:"get",headers:{Authorization:o(i)},url:a,data:u})},userSites:function(o){return e({method:"post",url:t.host+s.userSites,data:{SubscriptionID:t.subscriptionId,SubscriptionPassword:t.subscriptionPassword,Model:o}})},newEntityAction:function(n,r,u){var a=t.host.concat(s.newEntityAction,n,"/",u);return e({method:"post",headers:{Authorization:o(i)},url:a,data:r})},entityActionByCode:function(n,r,u,a){var c=t.host.concat(s.entityActionByCode,n,"/",r,"/",a);return e({method:"post",headers:{Authorization:o(i)},url:c,data:u})},entityActionByGID:function(n,r,u,a){var c=t.host.concat(s.entityActionByGID,n,"/",r,"/",a);return e({method:"post",headers:{Authorization:o(i)},url:c,data:u})},publicQuery:function(n,r,u){var a=t.host.concat(s.publicQuery,n,"/",r);return e({method:"get",headers:{Authorization:o(i)},url:a,data:u})}}}]}})})();