(function(){"use strict";var e=angular.module("es.Services.Web");e.factory("es.Services.StackTrace",function(){return{print:printStackTrace}});e.provider("$exceptionHandler",{$get:["es.Services.logService",function(e){return e}]});e.factory("es.Services.logService",["$log","$window","es.Services.StackTrace","$injector",function(e,t,r,n){function o(o,s){e.error.apply(e,arguments);try{var i=o.toString();var a=r.print({e:o});var c=c||n.get("es.Services.WebApi");var u={errorUrl:t.location.href,errorMessage:i,stackTrace:a,cause:s||""};c.esLog(u);console.log(angular.toJson(u))}catch(_){e.warn("Error logging failed");e.log(_)}}return o}])})();(function(){"use strict";var e=angular.module("es.Core.Filters",[]);e.filter("esTrustHtml",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}])})();(function(){"use strict";var e=angular.module("es.Services.Web",["ngStorage","ngSanitize"]);e.constant("ESWEBAPI_URL",{__LOGIN__:"api/Login",__PUBLICQUERY__:"api/rpc/PublicQuery/",__USERSITES__:"api/Login/Usersites",__SCROLLERROOTTABLE__:"api/rpc/SimpleScrollerRootTable/",__ENTITYACTION__:"api/Entity/",__ENTITYBYGIDACTION__:"api/EntityByGID/",__ELASTICSEARCH__:"api/esearch/",__SERVER_CAPABILITIES__:"api/Login/ServerCapabilities/",__ESLOG_MESSAGE__:"api/logMessage/"});e.value("__WEBAPI_RT__",{url:""});function t(e,t){return e.indexOf(t,e.length-t.length)!==-1}function r(e,t){return e.toLowerCase().indexOf(t.toLowerCase())===0}function n(e){var t=false;if(typeof e.__esrequest_sesssion!=="undefined"&&e.__esrequest_sesssion!==null){t=e.__esrequest_sesssion}if(t){return"Bearer "+t.WebApiToken}else{return""}}e.provider("es.Services.WebApi",function(){var e="";var o="";var s="";var i={host:"",allowUnsecureConnection:false,subscriptionId:"",subscriptionPassword:""};return{getSettings:function(){return i},setSettings:function(n){var a="https://";var c="http://";i=n;if(i.host){i.host=i.host.trim();if(r(i.host,a)){i.host=i.host.slice(a.length).trim()}else if(r(i.host,c)){i.host=i.host.slice(c.length).trim()}if(i.host==""){throw"host for Entersoft WEB API Server is not specified"}if(!t(i.host,"/")){i.host+="/"}o=c+i.host;s=a+i.host;if(i.allowUnsecureConnection){e=o}else{e=s}}else{throw"host for Entersoft WEB API Server is not specified"}return this},$get:["$http","$log","$sessionStorage","$q","ESWEBAPI_URL",function(t,r,a,c,u){return{openSession:function(r){delete a.__esrequest_sesssion;return t({method:"post",url:e+u.__LOGIN__,data:{SubscriptionID:i.subscriptionId,SubscriptionPassword:i.subscriptionPassword,Model:r}})},setUser:function(e){var t=e.Model;a.__esrequest_sesssion=t},getUser:function(){return a.__esrequest_sesssion||false},logout:function(){delete a.__esrequest_sesssion},esLog:function(t){if(!t){return}var o=angular.copy(t);try{o.__SubscriptionID=i.subscriptionId;o.__ServerUrl=e;o.__EDate=new Date;$.ajax({type:"POST",url:e.concat(u.__ESLOG_MESSAGE__),contentType:"application/json",headers:{Authorization:n(a)},data:angular.toJson(o)})}catch(s){r.warn("Error logging failed");r.log(s)}},fetchServerCapabilities:function(){var e=c.defer();t.get(o+u.__SERVER_CAPABILITIES__).success(function(t){e.resolve(t)}).error(function(){t.get(s+u.__SERVER_CAPABILITIES__).success(function(t){e.resolve(t)}).error(function(t,r,n,o){e.reject([t,r,n,o])})});return e.promise},fetchSimpleScrollerRootTable:function(r,o,s){var i=e.concat(u.__SCROLLERROOTTABLE__,r,"/",o);return t({method:"get",headers:{Authorization:n(a)},url:i,data:s})},fetchUserSites:function(r){return t({method:"post",url:e+u.__USERSITES__,data:{SubscriptionID:i.subscriptionId,SubscriptionPassword:i.subscriptionPassword,Model:r}})},executeNewEntityAction:function(r,o,s){var i=e.concat(u.__ENTITYACTION__,r,"/",s);return t({method:"post",headers:{Authorization:n(a)},url:i,data:o})},executeEntityActionByCode:function(r,o,s,i){var c=e.concat(u.__ENTITYACTION__,r,"/",o,"/",i);return t({method:"post",headers:{Authorization:n(a)},url:c,data:s})},executeEntityActionByGID:function(r,o,s,i){var c=e.concat(u.__ENTITYBYGIDACTION__,r,"/",o,"/",i);return t({method:"post",headers:{Authorization:n(a)},url:c,data:s})},fetchPublicQuery:function(r,o,s){var i=e.concat(u.__PUBLICQUERY__,r,"/",o);return t({method:"get",headers:{Authorization:n(a)},url:i,data:s})},eSearch:function(r,o,s){var i=e.concat(u.__ELASTICSEARCH__,r);return t({method:o,headers:{Authorization:n(a)},url:i,data:s})}}}]}});e.factory("es.Services.ElasticSearch",["es.Services.WebApi",function(e){return{searchIndex:function(t,r){var n=t+"/_search";return e.eSearch(n,"post",r)},searchIndexAndDocument:function(t,r,n){var o=t+"/"+r+"/_search";return e.eSearch(o,"post",n)},searchFree:e.eSearch}}])})();